---
title: "[Dreamhack] Quiz: x86 Assembly 2"
date: 2022-02-28 00:00:00
categories: [Write-Up, Dreamhack]
tags: [assembly, dreamhack, quiz]
---

> **Dreamhack x86 Assembly** ê°•ì˜ë¥¼ ë“£ê³  í‘¼ Quizë¥¼ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
{: .prompt-info}

<br>

## # Quiz

---

![image](https://user-images.githubusercontent.com/37824335/223080923-30b09d5b-4b01-4699-8869-6317a15b3408.png){: w="700" }

<br>

## # í’€ì´

---

```
[Register]
rcx = 0
rdx = 0
rsi = 0x400000
=======================
[Memory]
0x400000 | 0x67 0x55 0x5c 0x53 0x5f 0x5d 0x55 0x10
0x400008 | 0x44 0x5f 0x10 0x51 0x43 0x43 0x55 0x5d
0x400010 | 0x52 0x5c 0x49 0x10 0x47 0x5f 0x42 0x5c
0x400018 | 0x54 0x11 0x00 0x00 0x00 0x00 0x00 0x00
=======================
[code]
1: mov dl, BYTE PTR[rsi+rcx]
2: xor dl, 0x30
3: mov BYTE PTR[rsi+rcx], dl
4: inc rcx
5: cmp rcx, 0x19
6: jg end
7: jmp 1
```

- ğŸ“Œ**code 1** : `rsi + rcx`ì˜ ì£¼ì†Œë¥¼ ì°¸ì¡°í•œ ê°’ì„ `dl` ë ˆì§€ìŠ¤í„°ì— ë³µì‚¬

    > **dl** : RDX(Extended Data Register), DX(Data Register)ì˜ í•˜ìœ„ 8bit ë ˆì§€ìŠ¤í„°

    **Result** : `dl = 0x67 0x55 0x5c 0x53 0x5f 0x5d 0x55 0x10`

<br />

- ğŸ“Œ**code 2** : `dl` ë ˆì§€ìŠ¤í„° ê°’ê³¼ `0x30` ê°’ì„ xor ì—°ì‚°í•˜ì—¬ `dl`ì— ì €ì¥

    ![image](https://user-images.githubusercontent.com/37824335/223082535-c5b7ce4f-f934-43fb-8e5e-9c4dbada4233.png)

    **Result** : `dl = 0x57 0x65 0x6C 0x63 0x6F 0x6D 0x65 0x20`

<br />

- ğŸ“Œ**code 3** : `dl` ë ˆì§€ìŠ¤í„° ê°’ì„ `rsi + rcx` ì£¼ì†Œ ì°¸ì¡° ê°’ì— ë³µì‚¬

    **Result** : `0x400000 <= 0x57 0x65 0x6C 0x63 0x6F 0x6D 0x65 0x20`

<br />

- ğŸ“Œ**code 4** : `rcx` ê°’ 1 ì¦ê°€

    **Result** : `rcx = 0x1`

<br />

- ğŸ“Œ**code 5** : `rcx` ê°’ê³¼ `0x19` í¬ê¸° ë¹„êµ

<br />

- ğŸ“Œ**code 6** : `rcx` ê°’ì´ `0x19`ë³´ë‹¤ í¬ë©´ endë¡œ jump

    **Result** : `0x1 > 0x19` (False)

<br />

- ğŸ“Œ**code 7** : 1ë¡œ jump

<br />

ë¯¸ë£¨ì–´ ë³´ì•„, `rcx`ëŠ” 1ì”© ì¦ê°€í•˜ê³  `rsi + rcx`ëŠ”`0x400000`ë¶€í„° `0x400019`ê¹Œì§€ ì ‘ê·¼í•˜ë©° xor ì—°ì‚°ì„ í•  ê²ƒì´ë‹¤. ë”°ë¼ì„œ ë„¤ ë©”ëª¨ë¦¬ ê³µê°„ì— ëª¨ë‘ xor ì—°ì‚°ì„ í•œ ê²°ê³¼ë¥¼ ASCIIë¡œ ë³€í™˜í•˜ë©´ ì›í•˜ëŠ” ë¬¸ìì—´ì„ ì–»ì–´ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤!

<br />

**Result**

`0x400000` ~ `0x400019` => Convert Hex to ASCII using [Online tool](https://www.rapidtables.com/convert/number/hex-to-ascii.html)

```
[Before Memory]
0x400000 | 0x67 0x55 0x5c 0x53 0x5f 0x5d 0x55 0x10 : gU\S_]U
0x400008 | 0x44 0x5f 0x10 0x51 0x43 0x43 0x55 0x5d : D_QCCU]
0x400010 | 0x52 0x5c 0x49 0x10 0x47 0x5f 0x42 0x5c : R\IG_B\
0x400018 | 0x54 0x11 0x00 0x00 0x00 0x00 0x00 0x00 : T

[After Memory]
0x400000 | 0x57 0x65 0x6C 0x63 0x6F 0x6D 0x65 0x20 : Welcome
0x400008 | 0x74 0x6F 0x20 0x61 0x73 0x73 0x65 0x6D : to assem
0x400010 | 0x62 0x6C 0x79 0x20 0x77 0x6F 0x72 0x6C : bly worl
0x400018 | 0x64 0x21 0x30 0x30 0x30 0x30 0x30 0x30 : d!000000
```

![image](https://user-images.githubusercontent.com/37824335/223082601-6d1369f6-06c5-49f3-a9b1-753ffdaa3e8a.png)
