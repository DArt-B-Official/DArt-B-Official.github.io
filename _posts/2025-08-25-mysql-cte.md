---
title: "2주차 정규과제 - MySQL 공식문서: Common Table Expressions (CTE)"
date: 2025-08-26 09:00:00 +0900
categories: [SQL_ADVANCED, Week2]
tags: [MySQL, CTE, 공식문서, 번역]
---

# Common Table Expressions (공통 테이블 표현식, CTE)

> **원문 출처:** [MySQL 8.0 Reference Manual - 15.2.20 WITH (Common Table Expressions)](https://dev.mysql.com/doc/refman/8.0/en/with.html)  
> **번역:** DArt-B 학회

---

## 개요

**공통 테이블 표현식(Common Table Expression, CTE)** 은 하나의 SQL 문(statement) 안에서만 유효한 **이름이 지정된 임시 결과 집합**입니다.  
CTE는 동일한 SQL 문 안에서 여러 번 참조할 수 있습니다.  

CTE는 보통 `WITH` 절로 정의하며, 이후 SELECT/UPDATE/DELETE 등 구문에서 테이블처럼 사용할 수 있습니다.

---

## 기본 문법

```sql
WITH
  cte1 AS (SELECT a, b FROM table1),
  cte2 AS (SELECT c, d FROM table2)
SELECT b, d
FROM cte1 JOIN cte2
WHERE cte1.a = cte2.c;
```

- `cte1`, `cte2`는 `WITH` 절 안에서 정의된 임시 테이블(CTE)  
- 이후의 `SELECT` 구문에서 일반 테이블처럼 사용할 수 있음  
- 하나의 `WITH` 절 안에는 여러 개의 CTE를 정의 가능  

---

## CTE 이름과 컬럼명

1. **컬럼명 직접 지정**
```sql
WITH cte (col1, col2) AS (
  SELECT 1, 2
  UNION ALL
  SELECT 3, 4
)
SELECT col1, col2 FROM cte;
```

2. **컬럼명 생략 시 → 첫 번째 SELECT의 별칭 사용**
```sql
WITH cte AS (
  SELECT 1 AS col1, 2 AS col2
  UNION ALL
  SELECT 3, 4
)
SELECT col1, col2 FROM cte;
```

---

## CTE 사용 가능 위치

- SELECT / UPDATE / DELETE 문 앞
  ```sql
  WITH ... SELECT ...
  WITH ... UPDATE ...
  WITH ... DELETE ...
  ```

- 서브쿼리 안
  ```sql
  SELECT * FROM (WITH ... SELECT ...) AS dt;
  ```

- INSERT, REPLACE, CREATE TABLE/VIEW, DECLARE CURSOR, EXPLAIN 구문과 함께 사용 가능

---

## 주의 사항

- 같은 레벨에서 `WITH`를 두 번 연속 쓸 수 없음 → `,` 로 구분해야 함  
- 하나의 `WITH` 절 안에서는 CTE 이름이 고유해야 함  
- CTE는 **바깥 쿼리 블록의 CTE 참조는 가능**, **안쪽 블록의 CTE는 참조 불가**  
- CTE는 파생 테이블과 비슷하지만, **여러 번 참조 가능**하다는 점에서 더 유리  

---

여기까지가 MySQL 공식문서 *15.2.20 WITH (Common Table Expressions)* 중, **비재귀(Non-Recursive) CTE**에 관한 번역 및 정리입니다.
